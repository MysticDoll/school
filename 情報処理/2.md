# 関係モデルの位置づけ
## 関係モデル
- 関係データベースの重要な基礎をなすデータモデル
- SQLの
データモデルは関係モデルとは異なる

|関係データモデル|SQL|
|:-------------:|:--:|
|関係/リレーション(relation)|表/テーブル|
|タプル(tuple)|行(row)|
|属性(attribute)|列(column)|
|演算子(operator)|演算子(operator),関数(function),手続き(procedure), ルーチン(routine), メソッド(Method)|


## 製品ではなく原理
- 本質であり、持続的
- 妥協や取捨選択は常に概念的な立場から行うべき

## (オリジナルの)関係モデル
### 誕生
- 1968 E.F.Codd,IBM
- 数学的理論によるデータ管理のための原理や厳格なモデルを確立
- のちに様々な拡張や修正モデルの提案が存在

### 基本要素
- 構造
  - 関係, タプル, 型, 属性, キー, 外部キーなど
- 整合性(整合性制約)
  - 実態整合性, 参照整合性など
- 操作
  - 関係代数, 関係代入など

* データ定義ではいずれも宣言的に与える not 手続き的
- 宣言に適した実現方法をシステムが選択する

### 構造(relation)
- 対象世界における同種(同一構造)の事実を記述したデータの集合
- 見出しと本体の組
  - あるいは関係スキーマと関係インスタンスの組
###　見出し(heading)
- ある関係の構造を与える、名前が重複しない属性の集合
* 関係スキーマ(relation shceme) = 見出し + 制約
### 本体(body)
- ある見出しの構造に従ったデータ(タプル)の集合
* 関係インスタンス(relation instance)

### 型(type)
- 値の取り得る範囲を表す集合(ドメイン(定義域,domain))や、それに対する操作などの組

### 属性(attribute)
- 属性名と型の組
- 表で表現したときの列に相当

### 属性値
- ある属性の一つの値

### タプル
- 属性値の組
- 表で表現したときの行に相当

### 次数(degree),項数(arity)
- 属性数
### 濃度(cardinality)
- タプル数

### 関係に関する註
- 数学でのn項関係に由来
  - 関係同市を関連付けることからの命名ではない
  - 集合であるため同じタプルを含まない
- 関係は表として表現できるが表そのものではない
- 特に指定しない限り本書では型名と属性名は同じであるとみなす。

## 関係データベース(relational database, RDB)
- 対象世界における事実を記述したデータの集合体
- 関係の集合として定義される

### 候補キー(candidate key)
- タプルを特定可能な、一意な識別子となる属性の組
- 全ての関係に少なくとも一つは存在
- 例
  - DEPTにおける {DNO}, EMP における {ENO}
### 主キー(primary key)
- 候補キーのうち、主なものとして意図的に選ばれたもの
- スキーマでは下線で、本書の図中では二重下線で表現
### 外部キー(foreign key)
- 他の関係のある候補キーの値と一致するような属性の組
  - 参照する側の値が参照される側の値が必ず存在すること

## 整合性制約 (integrity constraint)
- 必ず真となるブール式で、少なくとも次の二つを含む

### 実体整合性(entity integrity)
- 主キー属性にnullが含まれてはならない
- nullは未知の値を意味するマーカー(値ではない)

### 参照整合性(referential integrity)
- 外部キーに一致しない値が存在してはならない

## 関係代数(relational algebra)
- 関係から関係を計算する関係演算子の集合
- 関係演算子は副作用を持たない
- 関係代数の閉包性(closure property)により演算子を組み合わせた関係 式として操作を表現可能

## 関係代入(relational assignment)
- 関係式の値の代入
- 更新を行うための手段

* 関係論理 (relational calculus)
- 関係代数と同等の(関係完備(relational complete)な)表現力を持つ論理計算体系

### 主な関係演算子
- σ
  - 制限(restrict) (あるいは選択(select))
- π
  - 射影(project)
- χ
  - 積(product) (あるいは、直積(cartesian product))
- ∩
  - 交わり, 共通部分(intersect)(あるいは積集合)
- ∪
  - 和(union)
- \-
  差(difference)
- ⋈
  - 結合(join)
- ÷
  - 商(devide)


### 関係データベースの例
#### サプライヤ
- S(SNO, SNAME, STATUS, CITY)
* DNAMEは一意とは限らない為キーではない

#### 部品
- P(PNO, PNAME, COLOR, WIGHT, CITY)

#### 出荷
- SP(SNO,PNOD,QTY)
- FK
  - {SNO}, {PNO}
  * 特定のサプライヤが特定の部品を出荷できるのは一度までとする

## データモデル
1. データ構造、データ演算子など、ユーザが操作する抽象機械の構成要素を、抽象的・自己完結的・論理的に定義したもの(メタモデル)
2. 特定のシステムにおける永続データのモデル

## データモデルの実装
- そのモデルを構成する抽象機械の構成要素を物理的に具現化したもの
- 例
  - ディスク上に格納される方法
    - 個々のデータ値がエンコードされる方法
    - 索引(index)などのアクセスパスの存在

## データ独立性
データを物理的に格納したり取得したりする方法を自由に変更することができ、その際にユーザにデータを提供する方法を変更する必要がないこと
### 物理的データ独立性
### 論理的データ独立性
外部スキーマ と 概念スキーマ 間 -> 論理的データ独立性
概念スキーマ と 内部スキーマ 間 -> 物理的データ独立性

## 関係の特性
### 関係に重複するタプルが含まれることはない
- 関係演算の結果も同様
- SQLでは重複が許される
### 関係のタプルの順序は不定
- SQLでは順序付け可能
  - 順序を与えるには明示的に order byで指定
###　関係の属性に順序はない
- SQLでは属性の順序に意味がある
  - 順序を入れ替えたテーブルは等しくない
### 関係は常に第一正規形(first normal form, INF)である
- いずれの属性値も、その方の単一の値である
### 基底関係
- あるデータベースにあらかじめ存在する関係
- 物理的な格納方法とは独立した概念
### 派生関係
- 関係演算によって得られる関係
## ビュー(または、仮想関系)
- 特定の関係式を評価した結果を値に持つ名前つきの関係
- 一般に、参照時に計算され、実体化される
- 動的に生成される基底関係と考えることができる



